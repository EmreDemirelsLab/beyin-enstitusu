<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Renkli Daire Egzersizi | ForBrain Learning Center</title>
    <style>
        :root {
            --primary-color: #0f4c8a; /* Dark blue from the logo */
            --primary-color-transparent: rgba(15, 76, 138, 0.85); /* Semi-transparent primary */
            --secondary-color: #65c8e5; /* Light blue from the logo */
            --secondary-color-transparent: rgba(101, 200, 229, 0.85); /* Semi-transparent secondary */
            --accent-color: #8cc63f; /* Green from the logo */
            --accent-color-transparent: rgba(140, 198, 63, 0.85); /* Semi-transparent accent */
            --success-color: #06d6a0;
            --danger-color: #ef476f;
            --warning-color: #ffd166;
            --light-color: #f9fbff;
            --dark-color: #333333;
            --grey-color: #f0f2f5;
            --white-transparent: rgba(255, 255, 255, 0.9);
            --shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
            
            /* Responsive units */
            --container-padding: 5%;
            --card-padding: clamp(0.5rem, 1.8vw, 1rem);
            --section-margin: clamp(0.8rem, 2.5vw, 1.5rem);
            --heading-size: clamp(1.1rem, 3vw, 1.6rem);
            --subheading-size: clamp(0.9rem, 1.8vw, 1.1rem);
            --text-size: clamp(0.85rem, 1.6vw, 0.95rem);
            --text-small: clamp(0.75rem, 1.3vw, 0.85rem);
            --icon-size: clamp(2.2rem, 5vw, 3rem);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        html {
            font-size: 16px; /* Base font size */
        }
        
        body {
            background-color: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
            overflow-x: hidden;
            overscroll-behavior: none;
            transition: var(--transition);
        }
        
        img {
            max-width: 100%;
            height: auto;
        }
        
        .container {
            width: 100%;
            max-width: 70rem; /* 1120px - slightly smaller */
            margin: 0 auto;
            padding: 0 var(--container-padding);
        }
        
        /* Navbar Styles */
        .navbar {
            background-color: rgba(255, 255, 255, 0.95);
            padding: clamp(0.6rem, 1.5vw, 0.9rem) 0;
            box-shadow: var(--shadow);
            position: relative;
            z-index: 10;
            backdrop-filter: blur(4px);
        }
        
        .navbar .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: var(--primary-color);
        }
        
        .logo img {
            width: 60%;
            max-width: 15.625rem; /* 250px */
            min-width: 9.375rem; /* 150px */
            height: auto;
        }
        
        .back-button {
            color: var(--primary-color);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 0.3125rem;
            background: var(--grey-color);
            transition: background 0.3s;
            font-size: var(--text-small);
            font-weight: 500;
        }
        
        .back-button:hover {
            background: #e5e9f0;
        }
        
        /* Header Styles */
        header {
            background-color: transparent;
            color: var(--primary-color);
            padding: clamp(0.5rem, 1.2vw, 0.8rem) 0;
            text-align: center;
            margin: var(--section-margin) 0 clamp(0.3rem, 1vw, 0.6rem);
        }
        
        header h1 {
            margin: 0;
            font-weight: 500;
            font-size: var(--heading-size);
            letter-spacing: 0.5px;
        }
        
        /* Exercise Info */
        .exercise-info {
            background-color: var(--white-transparent);
            border-radius: 0.4rem;
            padding: var(--card-padding);
            margin: 0.5rem auto var(--section-margin);
            text-align: center;
            color: #444;
            font-size: var(--text-small);
            line-height: 1.5;
            box-shadow: var(--shadow);
            max-width: 85%; /* Smaller width */
            border-left: 3px solid var(--primary-color);
            backdrop-filter: blur(4px);
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        
        .exercise-info:hover {
            transform: translateY(-2px);
            opacity: 0.95;
        }
        
        /* Toolbar */
        .toolbar {
            background-color: white;
            padding: var(--card-padding);
            display: flex;
            flex-wrap: wrap;
            gap: 0.625rem;
            border-radius: 0.5rem;
            box-shadow: var(--shadow);
            margin-bottom: clamp(0.4rem, 1.5vw, 0.8rem);
            align-items: center;
            position: relative;
            z-index: 5;
        }
        
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-btn {
            background: var(--light-color);
            border: 1px solid var(--grey-color);
            border-radius: 0.375rem;
            padding: 0;
            display: flex;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 0.0625rem 0.1875rem rgba(0,0,0,0.05);
        }
        
        .dropdown-btn:hover, .dropdown-btn:active {
            background: var(--grey-color);
        }
        
        .dropdown-title {
            border-right: 1px solid var(--grey-color);
            padding: 0.5rem 0.625rem;
            font-weight: 500;
            font-size: 0.875rem;
        }
        
        .dropdown-arrow {
            padding: 0.5rem;
            color: var(--primary-color);
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #fff;
            min-width: 10rem;
            box-shadow: 0 0.3125rem 0.9375rem rgba(0,0,0,0.1);
            z-index: 6;
            border-radius: 0.375rem;
            margin-top: 0.3125rem;
            overflow: hidden;
        }
        
        .dropdown-content a {
            color: var(--dark-color);
            padding: 0.625rem 0.9375rem;
            text-decoration: none;
            display: block;
            transition: background 0.2s ease;
        }
        
        .dropdown-content a:hover, .dropdown-content a:active {
            background-color: var(--grey-color);
            color: var(--primary-color);
        }
        
        /* Timer Bar */
        .timer-bar {
            background: rgba(15, 76, 138, 0.8);
            color: white;
            height: 2rem;
            line-height: 2rem;
            display: flex;
            justify-content: space-between;
            border-radius: 0.4rem;
            margin-bottom: 0.05rem;
            box-shadow: var(--shadow);
            position: relative;
            z-index: 2;
            backdrop-filter: blur(4px);
            transition: background 0.3s ease;
        }
        
        .timer-bar:hover {
            background: rgba(15, 76, 138, 0.9);
        }
        
        .info-text {
            padding: 0 0.8rem;
            font-weight: 500;
            font-size: var(--text-small);
            letter-spacing: 0.3px;
        }
        
        .timer {
            background-color: rgba(0, 0, 0, 0.15);
            color: white;
            padding: 0 1.1rem;
            border-radius: 0 0.4rem 0.4rem 0;
            font-weight: bold;
            font-size: 0.9rem;
            transition: background-color 0.3s ease;
        }
        
        /* Exercise Area */
        .exercise-area {
            position: relative;
            width: 100%;
            max-width: 100%;
            height: 38rem; /* Made larger like hedef-nesne */
            margin: 0.5rem auto;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 0.4rem;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-top: 0.625rem;
            position: relative;
            z-index: 1;
            transition: box-shadow 0.3s ease, background-color 0.3s ease;
            border: 1px solid rgba(240, 242, 245, 0.8);
        }
        
        .exercise-area:hover {
            box-shadow: 0 0.3rem 0.8rem rgba(0, 0, 0, 0.1);
        }
        
        .circle-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .growing-circle {
            position: absolute;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            left: 50%;
            top: 50%;
            background-color: transparent; /* Transparent background */
            border-width: 4px; /* Border width */
            border-style: solid; /* Border style */
        }
        
        .growing-circle::after {
            content: '';
            position: absolute;
            width: 6px; /* Center point size */
            height: 6px; /* Center point size */
            background-color: currentColor; /* Same color as the circle */
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        /* Overlay */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 76, 138, 0.6); /* Match hedef-nesne */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            border-radius: 0.4rem;
            backdrop-filter: blur(5px);
            transition: background 0.4s ease;
        }
        
        .overlay:hover {
            background: rgba(15, 76, 138, 0.7);
        }
        
        .start-button, .stop-button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 0.9375rem 2.5rem;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 3.125rem;
            box-shadow: 0 0.25rem 0.9375rem rgba(0,0,0,0.2);
            margin: 0.3125rem;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .start-button:active, .stop-button:active {
            transform: translateY(0.1875rem);
            box-shadow: 0 0.125rem 0.625rem rgba(0,0,0,0.2);
        }
        
        .stop-button {
            background: var(--danger-color);
            position: absolute;
            top: 0.9375rem;
            left: 0.9375rem;
            padding: 0.625rem 1.25rem;
            font-size: 1rem;
            z-index: 5;
            display: none;
        }
        
        /* Countdown */
        .countdown {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 5rem;
            height: 5rem;
            display: none; /* Start with display none - will be changed to flex by JS */
            background: white;
            color: var(--primary-color);
            border: 3px solid var(--primary-color);
            z-index: 20;
            border-radius: 50%;
            box-shadow: 0 0.3rem 1.25rem rgba(0,0,0,0.2);
            font-weight: bold;
            pointer-events: none;
            
            /* These properties will apply when the element is displayed */
            font-size: clamp(2.5rem, 5vw, 3.5rem);
            text-align: center; /* Additional centering for text */
            line-height: 5rem; /* Match height for vertical alignment */
        }
        
        
        
        /* Color Selection */
        .color-selection {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.9375rem;
            margin: 0.9375rem 0;
            max-height: 60vh;
            overflow-y: auto;
            padding: 0 0.625rem;
        }
        
        .color-option {
            display: flex;
            align-items: center;
            background-color: var(--grey-color);
            border-radius: 0.5rem;
            padding: 0.625rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .color-option:hover {
            background-color: #e9ecef;
            transform: translateY(-2px);
        }
        
        .color-option.selected {
            background-color: var(--primary-color);
            color: white;
        }
        
        .color-swatch {
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 50%;
            margin-right: 0.625rem;
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        .color-name {
            font-weight: 500;
            font-size: 0.875rem;
        }
        
        /* Completion Message */
        .completion-message {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0.4rem;
            padding: 1.1rem 1.6rem;
            text-align: center;
            max-width: 28rem;
            width: 90%;
            height: auto;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 0.4rem 1.2rem rgba(0,0,0,0.08);
            backdrop-filter: blur(5px);
            transform: translateY(10px);
            animation: slideUp 0.4s forwards;
            border-top: 3px solid var(--accent-color);
        }
        
        @keyframes slideUp {
            to { transform: translateY(0); }
        }
        
        .completion-title {
            color: var(--primary-color);
            font-size: 1.6rem;
            margin-top: 0.5rem;
            margin-bottom: 1rem;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        .result-stats {
            background-color: rgba(249, 251, 255, 0.7);
            border-radius: 0.4rem;
            padding: 0.8rem;
            margin: 0.5rem 0;
            text-align: left;
            font-size: 0.9rem;
            transition: background-color 0.3s ease;
        }
        
        .result-stats:hover {
            background-color: var(--light-color);
        }
        
        .result-stats p {
            margin: 0.4rem 0;
            display: flex;
            justify-content: space-between;
            transition: transform 0.2s ease;
        }
        
        .result-stats p:hover {
            transform: translateX(2px);
        }
        
        .result-stats p span {
            font-weight: 500;
            color: var(--primary-color);
        }
        
        .restart-button, .submit-button {
            background: var(--accent-color-transparent);
            color: white;
            border: none;
            padding: 0.7rem 2rem;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            margin-top: 1rem;
            transition: all 0.3s ease;
            border-radius: 2.5rem;
            box-shadow: 0 0.2rem 0.5rem rgba(0,0,0,0.1);
            user-select: none;
            -webkit-user-select: none;
            letter-spacing: 0.5px;
        }
        
        .restart-button:hover, .submit-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 0.3rem 0.7rem rgba(0,0,0,0.15);
            background: var(--accent-color);
        }
        
        .restart-button:active, .submit-button:active {
            transform: translateY(1px);
            box-shadow: 0 0.1rem 0.3rem rgba(0,0,0,0.1);
        }
        
        /* Fullscreen related */
        .fullscreen-button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            border-radius: 0.5rem;
            cursor: pointer;
            position: absolute;
            bottom: 0.9375rem;
            right: 0.9375rem;
            z-index: 5;
            box-shadow: 0 0.25rem 0.375rem rgba(0,0,0,0.1);
            transition: all 0.2s ease;
        }
        
        .fullscreen-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0.375rem 0.625rem rgba(0,0,0,0.15);
        }
        
        .fullscreen {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 9999;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .fullscreen .exercise-area {
            width: 100%;
            height: 100%;
            border-radius: 0;
            box-shadow: none;
        }
        
        .fullscreen-exit {
            position: absolute;
            top: 1.25rem;
            right: 1.25rem;
            background: rgba(0,0,0,0.2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 2.5rem;
            height: 2.5rem;
            font-size: 1.25rem;
            cursor: pointer;
            z-index: 10000;
            display: none;
            transition: all 0.2s ease;
        }
        
        .fullscreen-exit:hover {
            background: rgba(0,0,0,0.3);
        }
        
        /* Mobile Responsive Adjustments */
        @media (max-width: 48em) { /* 768px */
            .exercise-area {
                height: 34rem; /* Adjusted for better mobile display */
            }
            
            .color-selection {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .stats-container {
                top: 0.6rem;
                right: 0.6rem;
                padding: 0.3rem 0.5rem;
                font-size: 0.6rem;
                max-width: 7rem;
                border-radius: 0.3rem;
            }
            
            .countdown {
                width: 4.5rem;
                height: 4.5rem;
                line-height: 4.5rem;
                font-size: 2.2rem;
            }
            
            .toolbar {
                flex-direction: column;
                align-items: stretch;
                padding: 0.75rem;
            }
            
            .dropdown {
                margin-bottom: 0.5rem;
            }
            
            .completion-message {
                padding: 0.8rem 1.2rem;
                width: 85%;
            }
        }
        
        @media (max-width: 36em) { /* 576px */
            .completion-message {
                padding: 0.8rem;
                width: 85%;
            }
            
            .result-stats {
                padding: 0.6rem;
                font-size: 0.8rem;
            }
            
            .completion-title {
                font-size: 1.3rem;
                margin-bottom: 0.8rem;
            }
            
            .exercise-area {
                height: 32rem; /* Adjusted for mobile */
            }
            
            .toolbar {
                padding: 0.5rem;
            }
            
            .dropdown-btn .dropdown-title,
            .dropdown-btn .dropdown-arrow {
                padding: 0.4rem 0.6rem;
                font-size: 0.8rem;
            }
            
            .exercise-info {
                max-width: 95%;
                padding: 0.5rem;
            }
        }
        
        /* Print styles */
        @media print {
            .navbar, .toolbar, .stop-button, 
            .fullscreen-button, .fullscreen-exit, .overlay, .back-button {
                display: none !important;
            }
            
            .exercise-area, .completion-message {
                break-inside: avoid;
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
                background: white !important;
                backdrop-filter: none;
            }
        }
    </style>
</head>
<body>
    <div class="navbar">
        <div class="container">
            <a href="index.html" class="logo">
                <img src="logo.png" alt="ForBrain Learning Center Logo">
            </a>
            <a href="index.html" class="back-button">← Tüm Egzersizler</a>
        </div>
    </div>
    
    <div class="container">
        <header>
            <h1>Renkli Daire Egzersizi</h1>
        </header>
        
        <div class="exercise-info">
            Bu egzersiz, görsel algı ve kısa süreli bellek becerilerinizi geliştirmeyi amaçlar.
            Ekranın merkezinde farklı renklerde büyüyen daireler göreceksiniz.
            Bu dairelerin renklerini iyi gözlemleyin ve hatırlamaya çalışın.
            Egzersiz sonunda hangi renkleri gördüğünüzü seçmeniz istenecek.
            <br><br>
            <strong>Gözünüzü sabit tutun ve dairelerin büyümesini takip edin!</strong>
        </div>
        
        <div class="toolbar">
            <div class="dropdown">
                <button class="dropdown-btn" id="durationBtn">
                    <div class="dropdown-title" id="selectedDuration">1:00</div>
                    <div class="dropdown-arrow">▾</div>
                </button>
                <div id="durationDropdown" class="dropdown-content">
                    <a href="#" id="duration30">0:30</a>
                    <a href="#" id="duration60">1:00</a>
                    <a href="#" id="duration120">2:00</a>
                    <a href="#" id="duration180">3:00</a>
                </div>
            </div>
            
            <div class="dropdown">
                <button class="dropdown-btn" id="speedBtn">
                    <div class="dropdown-title" id="selectedSpeed">Normal</div>
                    <div class="dropdown-arrow">▾</div>
                </button>
                <div id="speedDropdown" class="dropdown-content">
                    <a href="#" id="speed1">Yavaş</a>
                    <a href="#" id="speed2">Normal</a>
                    <a href="#" id="speed3">Hızlı</a>
                </div>
            </div>
            
            <div class="dropdown">
                <button class="dropdown-btn" id="colorCountBtn">
                    <div class="dropdown-title" id="selectedColorCount">6 Renk</div>
                    <div class="dropdown-arrow">▾</div>
                </button>
                <div id="colorCountDropdown" class="dropdown-content">
                    <a href="#" id="colors2">2 Renk</a>
                    <a href="#" id="colors4">4 Renk</a>
                    <a href="#" id="colors6">6 Renk</a>
                    <a href="#" id="colors8">8 Renk</a>
                    <a href="#" id="colors10">10 Renk</a>
                </div>
            </div>
        </div>
        
        <div class="timer-bar">
            <span class="info-text">Daireleri izleyin ve renklerini hatırlamaya çalışın</span>
            <span class="timer" id="timer">01:00</span>
        </div>
        
        <div class="exercise-area" id="exerciseArea">
            <button class="fullscreen-button" id="fullscreenButton">Tam Ekran</button>
            <button class="fullscreen-exit" id="fullscreenExit">✕</button>
            <button class="stop-button" id="stopButton">Egzersizi Durdur</button>
            
            <div class="circle-container" id="circleContainer">
                <!-- Daireler JavaScript ile eklenecek -->
            </div>
            
            
            
            <div class="overlay" id="startOverlay">
                <button class="start-button" id="startButton">Egzersizi Başlat</button>
            </div>
            
            <div class="countdown" id="countdown">3</div>
            
            <div id="colorSelectionOverlay" class="overlay" style="display: none;">
                <div class="completion-message">
                    <h2 class="completion-title">Hangi Renkleri Gördünüz?</h2>
                    <p>Bu egzersiz sırasında gördüğünüz tüm renkleri seçin:</p>
                    
                    <div class="color-selection" id="colorSelection">
                        <!-- Renk seçenekleri JavaScript ile eklenecek -->
                    </div>
                    
                    <button class="submit-button" id="submitButton">Cevapları Gönder</button>
                </div>
            </div>
            
            <div id="completionOverlay" class="overlay" style="display: none;">
                <div class="completion-message">
                    <h2 class="completion-title">Egzersiz Tamamlandı!</h2>
                    <div class="result-stats">
                        <p>Toplam Daire: <span id="totalCircles">0</span></p>
                        <p>Doğru Hatırlanan Renkler: <span id="correctColors">0</span></p>
                        <p>Kaçırılan Renkler: <span id="missedColors">0</span></p>
                        <p>Fazladan İşaretlenen Renkler: <span id="extraColors">0</span></p>
                        <p>Başarı Oranı: <span id="successRate">0%</span></p>
                    </div>
                    <button class="restart-button" id="restartButton">Yeni Egzersiz Başlat</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Kullanılabilecek tüm renkler
        const allColors = [
            { name: "Kırmızı", value: "#e63946" },
            { name: "Mavi", value: "#457b9d" },
            { name: "Yeşil", value: "#2a9d8f" },
            { name: "Sarı", value: "#ffbe0b" },
            { name: "Mor", value: "#8338ec" },
            { name: "Siyah", value: "#1d3557" },
            { name: "Beyaz", value: "#f8f9fa" },
            { name: "Turuncu", value: "#fb8500" },
            { name: "Pembe", value: "#ff6392" },
            { name: "Turkuaz", value: "#48cae4" }
        ];

        // Egzersiz ayarları
        let duration = 60;  // saniye
        let speed = 2;      // 1: yavaş, 2: normal, 3: hızlı
        let maxColorCount = 6; // Maksimum gösterilecek renk sayısı (varsayılan 6)
        let availableColors = allColors.slice(0, maxColorCount);
        let exerciseStarted = false;
        let circleCount = 0;
        let shownColors = []; // Gösterilen renkler
        let isFullscreen = false;
        
        // Zamanlayıcılar
        let exerciseTimer;
        let circleTimer;
        let remainingTime = 60;
        
        // Hıza göre büyüme süreleri (ms)
        const growthDurations = [4000, 2500, 1500]; // yavaş, normal, hızlı
        
        // DOM elementleri hazır olduğunda çalışacak
        document.addEventListener('DOMContentLoaded', function() {
            setupUI();
        });
        
        // Kullanıcı arayüzü ayarları
        function setupUI() {
            // Dropdown açma işlemleri
            document.getElementById('durationBtn').addEventListener('click', function() {
                toggleDropdown('durationDropdown');
            });
            
            document.getElementById('speedBtn').addEventListener('click', function() {
                toggleDropdown('speedDropdown');
            });
            
            document.getElementById('colorCountBtn').addEventListener('click', function() {
                toggleDropdown('colorCountDropdown');
            });
            
            // Süre seçenekleri
            document.getElementById('duration30').addEventListener('click', function(e) {
                e.preventDefault();
                setDuration(30);
            });
            
            document.getElementById('duration60').addEventListener('click', function(e) {
                e.preventDefault();
                setDuration(60);
            });
            
            document.getElementById('duration120').addEventListener('click', function(e) {
                e.preventDefault();
                setDuration(120);
            });
            
            document.getElementById('duration180').addEventListener('click', function(e) {
                e.preventDefault();
                setDuration(180);
            });
            
            // Hız seçenekleri
            document.getElementById('speed1').addEventListener('click', function(e) {
                e.preventDefault();
                setSpeed(1);
            });
            
            document.getElementById('speed2').addEventListener('click', function(e) {
                e.preventDefault();
                setSpeed(2);
            });
            
            document.getElementById('speed3').addEventListener('click', function(e) {
                e.preventDefault();
                setSpeed(3);
            });
            
            // Renk sayısı seçenekleri
            document.getElementById('colors2').addEventListener('click', function(e) {
                e.preventDefault();
                setColorCount(2);
            });
            
            document.getElementById('colors4').addEventListener('click', function(e) {
                e.preventDefault();
                setColorCount(4);
            });
            
            document.getElementById('colors6').addEventListener('click', function(e) {
                e.preventDefault();
                setColorCount(6);
            });
            
            document.getElementById('colors8').addEventListener('click', function(e) {
                e.preventDefault();
                setColorCount(8);
            });
            
            document.getElementById('colors10').addEventListener('click', function(e) {
                e.preventDefault();
                setColorCount(10);
            });
            
            // Tam ekran butonları
            document.getElementById('fullscreenButton').addEventListener('click', toggleFullscreen);
            document.getElementById('fullscreenExit').addEventListener('click', exitFullscreen);
            
            // Butonlara olay dinleyicileri
            document.getElementById('startButton').addEventListener('click', startExercise);
            document.getElementById('stopButton').addEventListener('click', stopExercise);
            document.getElementById('submitButton').addEventListener('click', checkResults);
            document.getElementById('restartButton').addEventListener('click', resetExercise);
            
            // Dışarıya tıklandığında dropdown menüleri kapat
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.dropdown-btn') && !event.target.closest('.dropdown-content')) {
                    closeAllDropdowns();
                }
            });
            
            // ESC tuşu ile tam ekrandan çıkma
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && isFullscreen) {
                    exitFullscreen();
                }
            });
        }
        
        // Dropdown'u aç/kapat
        function toggleDropdown(id) {
            if (exerciseStarted) return;
            
            const dropdown = document.getElementById(id);
            const isOpen = dropdown.style.display === 'block';
            
            // Önce tüm dropdown'ları kapat
            closeAllDropdowns();
            
            // Tıklanan dropdown açık değilse aç
            if (!isOpen) {
                dropdown.style.display = 'block';
            }
        }
        
        // Tüm dropdown'ları kapat
        function closeAllDropdowns() {
            const dropdowns = document.getElementsByClassName('dropdown-content');
            for (let i = 0; i < dropdowns.length; i++) {
                dropdowns[i].style.display = 'none';
            }
        }
        
        // Süreyi ayarla
        function setDuration(seconds) {
            duration = seconds;
            remainingTime = seconds;
            
            let durationText = '';
            if (seconds < 60) {
                durationText = `0:${seconds < 10 ? '0' : ''}${seconds}`;
            } else {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                durationText = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            }
            
            document.getElementById('selectedDuration').innerText = durationText;
            document.getElementById('timer').innerText = durationText;
            closeAllDropdowns();
        }
        
        // Hızı ayarla
        function setSpeed(newSpeed) {
            speed = newSpeed;
            const speedTexts = ['Yavaş', 'Normal', 'Hızlı '];
            document.getElementById('selectedSpeed').innerText = speedTexts[newSpeed - 1];
            closeAllDropdowns();
        }
        
        // Renk sayısını ayarla
        function setColorCount(count) {
            maxColorCount = count;
            availableColors = allColors.slice(0, maxColorCount);
            document.getElementById('selectedColorCount').innerText = `${count} Renk`;
            closeAllDropdowns();
        }
        
        // Tam ekran modunu aç/kapat
        function toggleFullscreen() {
            const exerciseArea = document.getElementById('exerciseArea');
            
            if (!isFullscreen) {
                isFullscreen = true;
                exerciseArea.classList.add('fullscreen');
                document.getElementById('fullscreenExit').style.display = 'block';
                document.getElementById('fullscreenButton').style.display = 'none';
                
                
                
            }
        }
        
        // Tam ekrandan çık
        function exitFullscreen() {
            const exerciseArea = document.getElementById('exerciseArea');
            
            if (isFullscreen) {
                isFullscreen = false;
                exerciseArea.classList.remove('fullscreen');
                document.getElementById('fullscreenExit').style.display = 'none';
                document.getElementById('fullscreenButton').style.display = 'block';
                
                
            }
        }
        
        // Zamanı formatla
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins < 10 ? '0' : ''}${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }
        
        // Rastgele renk seç
        function getRandomColor() {
            const randomIndex = Math.floor(Math.random() * availableColors.length);
            return availableColors[randomIndex];
        }
        
        // Yeni daire oluştur ve büyüt
        function createAndGrowCircle() {
            if (!exerciseStarted) return;
            
            // Daire sayısını artır
            circleCount++;
            
            
            // Rastgele renk seç
            const selectedColor = getRandomColor();
            
            // Eğer renk daha önce gösterilmediyse listeye ekle
            if (!shownColors.some(color => color.name === selectedColor.name)) {
                shownColors.push(selectedColor);
                
            }
            
            // Daire oluştur
            const circle = document.createElement('div');
            circle.className = 'growing-circle';
            circle.style.borderColor = selectedColor.value;
            circle.style.color = selectedColor.value; // Merkez noktanın rengini ayarlar
            circle.style.width = '10px';
            circle.style.height = '10px';
            
            // Daireyi container'a ekle
            const container = document.getElementById('circleContainer');
            container.appendChild(circle);
            
            // Büyüme animasyonu
            const growthDuration = growthDurations[speed - 1];
            const startTime = performance.now();
            
            // Egzersiz alanının boyutlarını al
            const exerciseArea = document.getElementById('exerciseArea');
            const areaWidth = exerciseArea.clientWidth;
            const areaHeight = exerciseArea.clientHeight;
            
            // Minimum boyut (ekranın %80'i veya 100vmin)
            const maxSize = Math.min(areaWidth, areaHeight) * 0.8;
            
            function grow(timestamp) {
                if (!exerciseStarted) return;
                
                const elapsed = timestamp - startTime;
                const progress = Math.min(elapsed / growthDuration, 1);
                const size = progress * maxSize;
                
                circle.style.width = `${size}px`;
                circle.style.height = `${size}px`;
                
                if (progress < 1) {
                    requestAnimationFrame(grow);
                } else {
                    // Daire büyümesi tamamlandı
                    setTimeout(() => {
                        if (container.contains(circle)) {
                            container.removeChild(circle);
                        }
                        
                        // Egzersiz devam ediyorsa sonraki daireyi planla
                        if (exerciseStarted) {
                            const waitTime = 1000; // Sabit bekleme süresi 1 saniye
                            circleTimer = setTimeout(createAndGrowCircle, waitTime);
                        }
                    }, 200);
                }
            }
            
            // Büyüme animasyonunu başlat
            requestAnimationFrame(grow);
        }
        
        // Egzersizi başlat
        function startExercise() {
            // Egzersiz zaten başladıysa işlem yapma
            if (exerciseStarted) return;
            
            // Değişkenleri sıfırla
            exerciseStarted = true;
            circleCount = 0;
            shownColors = [];
            remainingTime = duration;
            
            
            
            
            // UI elemanlarını güncelle
            document.getElementById('stopButton').style.display = 'block';
            document.getElementById('startOverlay').style.display = 'none';
            document.getElementById('timer').innerText = formatTime(remainingTime);
            
            // Tam ekran modunu etkinleştir
            if (!isFullscreen) {
                toggleFullscreen();
            }
            
            // Geri sayımı göster
            const countdownEl = document.getElementById('countdown');
            countdownEl.style.display = 'block';
            countdownEl.innerText = '3';
            
            // Manuel olarak geri sayım yap, fonksiyon çağrıları ile
            startCountdown();
        }
        
        // Geri sayımı başlat
        function startCountdown() {
            const countdownEl = document.getElementById('countdown');
            let count = 3;
            
            function updateCountdown() {
                countdownEl.innerText = count;
                
                if (count > 0) {
                    count--;
                    setTimeout(updateCountdown, 1000);
                } else {
                    countdownEl.style.display = 'none';
                    
                    // Egzersizi başlat
                    startTimer();
                    createAndGrowCircle();
                }
            }
            
            // İlk güncellemeyi başlat
            updateCountdown();
        }
        
        // Zamanlayıcıyı başlat
        function startTimer() {
            exerciseTimer = setInterval(function() {
                remainingTime--;
                document.getElementById('timer').innerText = formatTime(remainingTime);
                
                if (remainingTime <= 0) {
                    endExercise();
                }
            }, 1000);
        }
        
        // Egzersizi durdur
        function stopExercise() {
            if (!exerciseStarted) return;
            endExercise();
        }
        
        // Egzersizi sonlandır
        function endExercise() {
            // Egzersiz durumunu güncelle
            exerciseStarted = false;
            
            // Tüm zamanlayıcıları temizle
            clearInterval(exerciseTimer);
            clearTimeout(circleTimer);
            
            // Tüm daireleri temizle
            document.getElementById('circleContainer').innerHTML = '';
            
            // UI elemanlarını güncelle
            
            document.getElementById('stopButton').style.display = 'none';
            
            // Renk seçim ekranını göster
            prepareColorSelection();
        }
        
        // Renk seçim ekranını hazırla
        function prepareColorSelection() {
            // Get the container and clear any previous options
            const colorSelection = document.getElementById('colorSelection');
            colorSelection.innerHTML = '';
          
            // Loop over allColors (10 items), not just the subset you used
            allColors.forEach(color => {
              // Create the outer option div
              const colorOption = document.createElement('div');
              colorOption.className = 'color-option';
              colorOption.dataset.color = color.name;
          
              // Create the swatch
              const colorSwatch = document.createElement('div');
              colorSwatch.className = 'color-swatch';
              colorSwatch.style.backgroundColor = color.value;
          
              // Create the label
              const colorName = document.createElement('div');
              colorName.className = 'color-name';
              colorName.innerText = color.name;
          
              // Assemble and append
              colorOption.appendChild(colorSwatch);
              colorOption.appendChild(colorName);
          
              // Toggle selection on click
              colorOption.addEventListener('click', function() {
                this.classList.toggle('selected');
              });
          
              colorSelection.appendChild(colorOption);
            });
          
            // Finally, show the overlay
            document.getElementById('colorSelectionOverlay').style.display = 'flex';
          }
        
        // Cevapları kontrol et
        function checkResults() {
            // Kullanıcının seçtiği renkleri topla
            const selectedOptions = document.querySelectorAll('.color-option.selected');
            const userSelectedColors = Array.from(selectedOptions).map(option => option.dataset.color);
            
            // Gerçekte gösterilen renkleri bul
            const actualColors = shownColors.map(color => color.name);
            
            // Doğru hatırlanan renkler
            const correctColors = userSelectedColors.filter(color => actualColors.includes(color));
            
            // Kaçırılan renkler
            const missedColors = actualColors.filter(color => !userSelectedColors.includes(color));
            
            // Fazladan işaretlenen renkler
            const extraColors = userSelectedColors.filter(color => !actualColors.includes(color));
            
            // Başarı oranı
            const successRate = actualColors.length > 0 ? 
                Math.round((correctColors.length / actualColors.length) * 100) : 0;
            
            // Sonuçları göster
            document.getElementById('totalCircles').innerText = circleCount;
            document.getElementById('correctColors').innerText = correctColors.length;
            document.getElementById('missedColors').innerText = missedColors.length;
            document.getElementById('extraColors').innerText = extraColors.length;
            document.getElementById('successRate').innerText = `${successRate}%`;
            
            // Renk seçim ekranını gizle ve sonuç ekranını göster
            document.getElementById('colorSelectionOverlay').style.display = 'none';
            document.getElementById('completionOverlay').style.display = 'flex';
        }
        
        // Egzersizi sıfırla
        function resetExercise() {
            // Sonuç ekranını gizle
            document.getElementById('completionOverlay').style.display = 'none';
            
            // Başlangıç ekranını göster
            document.getElementById('startOverlay').style.display = 'flex';
            
            // Zamanı sıfırla
            document.getElementById('timer').innerText = formatTime(duration);
            
            // Değişkenleri sıfırla
            remainingTime = duration;
            circleCount = 0;
            shownColors = [];
            
            // Tam ekrandan çık
            exitFullscreen();
        }
    </script>
</body>
</html>